<apex:page controller="DailyTransactionMonitoring">

    <apex:form >
        <apex:pageBlock >
            <apex:pageBlockSection columns="2">
                <apex:pageBlockSectionItem >
                    <apex:OutputLabel value="Date:" />
                    <apex:OutputPanel >
                        <apex:inputField value="{!dummyContact.BirthDate}" />
                        <apex:commandButton value="Change" id="cmd1" action="{!RefreshValues}" />
                        <script type="text/javascript" language="Javascript">
                            function setFocus(){
                                var mytext = document.getElementById('{!$Component.cmd1}'); 
                                mytext.focus();
                            }
                            function addEvent(obj, evType, fn) { 
                                if (obj.addEventListener) { 
                                    obj.addEventListener(evType, fn, false); 
                                    return true; 
                                } else if (obj.attachEvent) { 
                                    var r = obj.attachEvent("on"+evType, fn); 
                                    return r; 
                                } else { 
                                    return false; 
                                } 
                            }
                            addEvent(window, 'load', setFocus);
                        </script>
                    </apex:OutputPanel>
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem >
                    Show accounts where percentage
                    <apex:selectList value="{!moreOrLess}" size="1">
                        <apex:selectoptions value="{!MoLValues}" />
                        <apex:actionSupport event="onchange" action="{!RefreshValues}" />
                    </apex:selectList>
                </apex:pageBlockSectionItem>
            </apex:pageBlockSection>
            <apex:pageBlockSection columns="1">
                <apex:pageBlockTable value="{!items}" var="item">
                    <apex:column headerValue="Carrier ID" value="{!item.account.Carrier_ID__c}" />
                    <apex:column headerValue="Issuer ID" value="{!item.account.Corporate_Issuer__c}" />
                    <apex:column headerValue="Carrier Name" value="{!item.account.Name}" />
                    <apex:column headerValue="ST" value="{!item.account.BillingState}" />
                    <apex:column headerValue="Ave." value="{!item.average}" />
                    <apex:column headerValue="Curr." value="{!item.current}" />
                    <apex:column headerValue="Diff." value="{!item.diff}" />
                    <apex:column headerValue="%" value="{!item.percent}" />
                </apex:pageBlockTable>
            </apex:pageBlockSection>
            <apex:pageBlockButtons location="Bottom">
                <apex:commandButton value="Export to Excel" action="{!Export}" />
            </apex:pageBlockButtons>
        </apex:pageBlock>
    </apex:form>

</apex:page>