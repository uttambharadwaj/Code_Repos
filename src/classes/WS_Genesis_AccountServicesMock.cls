/* *************************
    Purpose:
        Provide WebServiceMock responses for testing WSUtil_Genesis_AccountServices.
    
    History:
        22-May-2014 M.Erwin (Salesforce.com)    Created
************************* */
@isTest
public class WS_Genesis_AccountServicesMock implements WebServiceMock {

    public void doInvoke(
			Object stub,
			Object request,
			Map<String, Object> response,
			String endpoint,
			String soapAction,
			String requestName,
			String responseNS,
			String responseName,
			String responseType) {

        System.debug(System.LoggingLevel.DEBUG, '##DEBUG:request: ' + request);

        if (request instanceOf WS_Genesis_AccountServices.CreateAccount_element) {
            System.debug(System.LoggingLevel.DEBUG, '##DEBUG:request is CreateAccount_element: ' + request);

            WS_Genesis_AccountServices.CreateAccount_element createAccountElement = (WS_Genesis_AccountServices.CreateAccount_element)request;

            // Create response element from the autogenerated class.
            WS_Genesis_AccountServices.CreateAccountResponse_element createAccountResponseElement = new WS_Genesis_AccountServices.CreateAccountResponse_element();
            createAccountResponseElement.UID = createAccountElement.UID;

            System.debug(System.LoggingLevel.DEBUG, '##DEBUG:WS_Testing_Util.TEST_PATH_ACCOUNT_PASS: ' + WS_Testing_Util.TEST_PATH_ACCOUNT_PASS);
            if (WS_Testing_Util.TEST_PATH_ACCOUNT_PASS) {
                createAccountResponseElement.AccountNumber = '123456789';
                System.debug(System.LoggingLevel.DEBUG, '##DEBUG:createAccountElement.UID: ' + createAccountElement.UID);
                System.debug(System.LoggingLevel.DEBUG, '##DEBUG:createAccountElement.UID: ' + createAccountElement.UID);
                createAccountResponseElement.Status = 'Approved';
                createAccountResponseElement.ReferredReason = 'Not mapped into Salesforce';
            } else {
            	WS_Genesis_AccountServices.Error_element errorElement = new WS_Genesis_AccountServices.Error_element();
            	errorElement.ErrorId = 'ERR104';
                errorElement.ErrorMessage = 'Genesis errors';
            	List<WS_Genesis_AccountServices.Error_element> errorElements = new List<WS_Genesis_AccountServices.Error_element>();
                errorElements.add(errorElement);
                WS_Genesis_AccountServices.ErrorBlock_element errorBlockElement = new WS_Genesis_AccountServices.ErrorBlock_element();
                errorBlockElement.Error = errorElements;
                createAccountResponseElement.ErrorBlock = errorBlockElement;
            }
            // Add response element to the response parameter
            response.put('response_x', createAccountResponseElement); 
        }
        if (request instanceOf WS_Genesis_AccountServices.AddCard_element) {
            System.debug(System.LoggingLevel.DEBUG, '##DEBUG:request is AddCard_element: ' + request);
            WS_Genesis_AccountServices.AddCard_element addCardElement = (WS_Genesis_AccountServices.AddCard_element)request;

            // Create response element from the autogenerated class.
            WS_Genesis_AccountServices.AddCardResponse_element addCardResponseElement = new WS_Genesis_AccountServices.AddCardResponse_element();
            addCardResponseElement.UID = addCardElement.UID;

            System.debug(System.LoggingLevel.DEBUG, '##DEBUG:addCardElement: ' + addCardElement);
	        WS_Genesis_AccountServices.Cards_element cardsElement = addCardElement.Cards;
	        List<WS_Genesis_AccountServices.Card_element> cards = cardsElement.Card;

            System.debug(System.LoggingLevel.DEBUG, '##DEBUG:WS_Testing_Util.TEST_PATH_CARD_PASS: ' + WS_Testing_Util.TEST_PATH_CARD_PASS);
            if (WS_Testing_Util.TEST_PATH_CARD_PASS) {
                WS_Genesis_AccountServices.CardsOutput_element cardsOuputElement = new WS_Genesis_AccountServices.CardsOutput_element();
                List<WS_Genesis_AccountServices.CardResult_element> cardResultElements = new List<WS_Genesis_AccountServices.CardResult_element>();
            	for(WS_Genesis_AccountServices.Card_element cardElement : cards) {
	                WS_Genesis_AccountServices.CardResult_element cardResultElement = new WS_Genesis_AccountServices.CardResult_element();
	                cardResultElement.CardAdded = 'true';
	                cardResultElement.CardIdentifier = cardElement.CardIdentifier;
	                System.debug(System.LoggingLevel.DEBUG, '##DEBUG:System.currentTimeMillis()): ' + System.currentTimeMillis());
	                cardResultElement.CardNumber = String.valueOf(System.currentTimeMillis());
	                cardResultElements.add(cardResultElement);
	            }
                cardsOuputElement.CardResult = cardResultElements;
                addCardResponseElement.CardsOutput = cardsOuputElement;
                addCardResponseElement.UID = addCardElement.UID;
            } else {
				List<WS_Genesis_AccountServices.CardError_element> cardErrorElements = new List<WS_Genesis_AccountServices.CardError_element>();
            	for(WS_Genesis_AccountServices.Card_element cardElement : cards) {
					WS_Genesis_AccountServices.CardError_element cardErrorElement = new WS_Genesis_AccountServices.CardError_element();
					cardErrorElement.CardIdentifier = cardElement.CardIdentifier;
					cardErrorElement.ErrorId = 'ERR104';
					cardErrorElement.ErrorMessage = 'Genesis errors';
					cardErrorElements.add(cardErrorElement);
				}
				WS_Genesis_AccountServices.CardErrorBlock_element cardErrorBlockElement = new WS_Genesis_AccountServices.CardErrorBlock_element();
				cardErrorBlockElement.CardError = cardErrorElements;
				addCardResponseElement.CardErrorBlock = cardErrorBlockElement;
            }

            // Add response element to the response parameter
            response.put('response_x', addCardResponseElement); 
        }
    }
}