<?xml version="1.0" encoding="UTF-8"?>
<ValidationRule xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>Email_Sent_From_Personal_Address</fullName>
    <active>true</active>
    <description>Prevents users sending emails from their personal email address &amp; prompts them to send it from a shared mailbox instead.</description>
    <errorConditionFormula>AND(

  /* Custom Setting - WE Validation Rules Controller - allows rule to be deactivated when the setting is changed */
   
  $Setup.WE_VRC__c.All_Case_Disabled__c = FALSE,

  OR(
    AND(
      Parent.RecordType.DeveloperName = &apos;Virtual_Business_Support_CS&apos;,
      NOT(FromAddress = &apos;business.support@wexeurope.com&apos;)
    ),
    AND(
      Parent.RecordType.DeveloperName = &apos;Virtual_Credit_CS&apos;,
      NOT(FromAddress = &apos;vcsupport@wexeurope.com&apos;)
    ),
    AND(
      Parent.RecordType.DeveloperName = &apos;Virtual_Prepaid_CS&apos;,
      NOT(FromAddress = &apos;customer.services@wexeurope.com&apos;)
    )
  ),

  /* rule shouldn&apos;t apply to Integration User - just in case */
  NOT($Profile.Id = &apos;00e70000000x9ty&apos;),
  /* rule doesn&apos;t apply to Bonnie MacArthur so that she can forward emails to DeskPro */
  NOT(FromAddress = &apos;bonnie.macarthur@wexeurope.com&apos;),
  /* rule doesn&apos;t apply to Anja Asghar so that she can forward emails to DeskPro, until 28/10/2016 */
  NOT(FromAddress = &apos;anja.asghar@wexeurope.com&apos;)

)</errorConditionFormula>
    <errorDisplayField>FromAddress</errorDisplayField>
    <errorMessage>Please send this email from your team&apos;s shared mailbox, rather than your personal email address</errorMessage>
</ValidationRule>
